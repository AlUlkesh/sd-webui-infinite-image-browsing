import{aQ as r,d as B,J as C,aV as b,r as m,G as w,y as I,K as s,L as c,O as i,N as g,R as l,U as y,V as S,W as T,X as V,Y as A,M as v,bx as N,Q as f,a0 as D}from"./index-9978fcf8.js";import{B as Q}from"./button-e19af4f8.js";const h=async()=>(await r.get("/db/basic_info")).data,q=async()=>{await r.post("/db/update_image_data",{},{timeout:1/0})},F=async o=>(await r.get("/db/match_images_by_tags",{params:{tag_ids:o.join()}})).data,L={key:0,class:"container"},M={class:"tag-list"},O=["onClick"],U=B({__name:"TagSearch",setup(o){const n=C(new b),e=m(),a=m(new Set),d=w(()=>e.value?e.value.tags.slice().sort((u,_)=>_.count-u.count):[]);I(async()=>{e.value=await h(),console.log(e,d)});const k=async()=>{n.pushAction(async()=>{await q(),e.value=await h()})},x=()=>{console.log(a.value),n.pushAction(()=>F(Array.from(a.value)))};return(u,_)=>{const p=Q;return e.value?(s(),c("div",L,[e.value.expired||!e.value.img_count?(s(),i(p,{key:0,onClick:k,loading:!n.isIdle,type:"primary"},{default:g(()=>[l(y(e.value.img_count===0?"gen idx":"updat index"),1)]),_:1},8,["loading"])):(s(),i(p,{key:1,type:"primary",onClick:x,loading:!n.isIdle},{default:g(()=>[l("search")]),_:1},8,["loading"])),S("ul",M,[(s(!0),c(T,null,V(v(d),t=>(s(),c("li",{key:t.id,class:A(["tag",{selected:a.value.has(t.id)}]),onClick:j=>a.value.has(t.id)?a.value.delete(t.id):a.value.add(t.id)},[a.value.has(t.id)?(s(),i(v(N),{key:0})):f("",!0),l(" "+y(t.name),1)],10,O))),128))])])):f("",!0)}}});const G=D(U,[["__scopeId","data-v-f1b34941"]]);export{G as default};
