import{d as A,u as oe,G as C,c as _e,_ as I,a as i,bs as Te,bt as je,r as Q,H as Le,W as q,P as V,C as he,t as se,a3 as ye,h as $,bu as te,a2 as Ce,z as Ne,s as be,bv as We,x as Me,k as ze,j as Ee,bw as Ae,w as Be,D as Se,b7 as Fe,F as Pe,bx as ne,M as L,K as w,L as G,X as xe,O as E,N as b,R as j,U as re,Q as N,by as Ue,a0 as Oe,y as ie,A as Re,ah as Ge,aT as U,bz as Ye,bA as Ve,bB as He,V as R,bC as Qe,bD as qe,bo as Xe,bl as ue,bE as Je,bF as Ze,bG as Ke,bH as et,bq as tt,b9 as nt,ba as rt}from"./index-3eae54c8.js";import{_ as at,F as ot}from"./index-80b56a21.js";import"./index-b363ae13.js";import{I as st}from"./index-ca5e55e8.js";import{u as we}from"./useTaskListStore-0675db92.js";import{W as lt,B as ct}from"./button-26bad4bf.js";import{u as it,c as ut}from"./copy2clipboard-8d41ed6e.js";import{T as dt,_ as ft}from"./task-6f7e13fa.js";var vt=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},pt=A({compatConfig:{MODE:3},name:"ACheckableTag",props:vt(),setup:function(e,r){var t=r.slots,a=r.emit,o=oe("tag",e),p=o.prefixCls,g=function(k){var d=e.checked;a("update:checked",!d),a("change",!d),a("click",k)},h=C(function(){var s;return _e(p.value,(s={},I(s,"".concat(p.value,"-checkable"),!0),I(s,"".concat(p.value,"-checkable-checked"),e.checked),s))});return function(){var s;return i("span",{class:h.value,onClick:g},[(s=t.default)===null||s===void 0?void 0:s.call(t)])}}});const ae=pt;var gt=new RegExp("^(".concat(Te.join("|"),")(-inverse)?$")),mt=new RegExp("^(".concat(je.join("|"),")$")),kt=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:V.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:V.any}},H=A({compatConfig:{MODE:3},name:"ATag",props:kt(),slots:["closeIcon","icon"],setup:function(e,r){var t=r.slots,a=r.emit,o=r.attrs,p=oe("tag",e),g=p.prefixCls,h=p.direction,s=Q(!0);Le(function(){e.visible!==void 0&&(s.value=e.visible)});var k=function(y){y.stopPropagation(),a("update:visible",!1),a("close",y),!y.defaultPrevented&&e.visible===void 0&&(s.value=!1)},d=C(function(){var v=e.color;return v?gt.test(v)||mt.test(v):!1}),c=C(function(){var v;return _e(g.value,(v={},I(v,"".concat(g.value,"-").concat(e.color),d.value),I(v,"".concat(g.value,"-has-color"),e.color&&!d.value),I(v,"".concat(g.value,"-hidden"),!s.value),I(v,"".concat(g.value,"-rtl"),h.value==="rtl"),v))});return function(){var v,y,_,x=e.icon,T=x===void 0?(v=t.icon)===null||v===void 0?void 0:v.call(t):x,S=e.color,W=e.closeIcon,M=W===void 0?(y=t.closeIcon)===null||y===void 0?void 0:y.call(t):W,D=e.closable,u=D===void 0?!1:D,l=function(){return u?M?i("span",{class:"".concat(g.value,"-close-icon"),onClick:k},[M]):i(he,{class:"".concat(g.value,"-close-icon"),onClick:k},null):null},f={backgroundColor:S&&!d.value?S:void 0},O=T||null,B=(_=t.default)===null||_===void 0?void 0:_.call(t),Y=O?i(q,null,[O,i("span",null,[B])]):B,K="onClick"in o,X=i("span",{class:c.value,style:f},[Y,l()]);return K?i(lt,null,{default:function(){return[X]}}):X}}});H.CheckableTag=ae;H.install=function(n){return n.component(H.name,H),n.component(ae.name,ae),n};const Ie=H;var De=se("normal","exception","active","success"),_t=se("line","circle","dashboard"),ht=se("default","small"),Z=function(){return{prefixCls:String,type:V.oneOf(_t),percent:Number,format:{type:Function},status:V.oneOf(De),showInfo:{type:Boolean,default:void 0},strokeWidth:Number,strokeLinecap:String,strokeColor:{type:[String,Object],default:void 0},trailColor:String,width:Number,success:{type:Object,default:function(){return{}}},gapDegree:Number,gapPosition:String,size:V.oneOf(ht),steps:Number,successPercent:Number,title:String}};function F(n){return!n||n<0?0:n>100?100:n}function J(n){var e=n.success,r=n.successPercent,t=r;return e&&"progress"in e&&(ye(!1,"Progress","`success.progress` is deprecated. Please use `success.percent` instead."),t=e.progress),e&&"percent"in e&&(t=e.percent),t}var yt=["from","to","direction"],Ct=function(){return $($({},Z()),{},{prefixCls:String,direction:{type:String}})},bt=function(e){var r=[];return Object.keys(e).forEach(function(t){var a=parseFloat(t.replace(/%/g,""));isNaN(a)||r.push({key:a,value:e[t]})}),r=r.sort(function(t,a){return t.key-a.key}),r.map(function(t){var a=t.key,o=t.value;return"".concat(o," ").concat(a,"%")}).join(", ")},St=function(e,r){var t=e.from,a=t===void 0?te.blue:t,o=e.to,p=o===void 0?te.blue:o,g=e.direction,h=g===void 0?r==="rtl"?"to left":"to right":g,s=Ce(e,yt);if(Object.keys(s).length!==0){var k=bt(s);return{backgroundImage:"linear-gradient(".concat(h,", ").concat(k,")")}}return{backgroundImage:"linear-gradient(".concat(h,", ").concat(a,", ").concat(p,")")}};const Pt=A({compatConfig:{MODE:3},name:"Line",props:Ct(),setup:function(e,r){var t=r.slots,a=C(function(){var s=e.strokeColor,k=e.direction;return s&&typeof s!="string"?St(s,k):{background:s}}),o=C(function(){return e.trailColor?{backgroundColor:e.trailColor}:void 0}),p=C(function(){var s=e.percent,k=e.strokeWidth,d=e.strokeLinecap,c=e.size;return $({width:"".concat(F(s),"%"),height:"".concat(k||(c==="small"?6:8),"px"),borderRadius:d==="square"?0:""},a.value)}),g=C(function(){return J(e)}),h=C(function(){var s=e.strokeWidth,k=e.size,d=e.strokeLinecap,c=e.success;return{width:"".concat(F(g.value),"%"),height:"".concat(s||(k==="small"?6:8),"px"),borderRadius:d==="square"?0:"",backgroundColor:c==null?void 0:c.strokeColor}});return function(){var s;return i(q,null,[i("div",{class:"".concat(e.prefixCls,"-outer")},[i("div",{class:"".concat(e.prefixCls,"-inner"),style:o.value},[i("div",{class:"".concat(e.prefixCls,"-bg"),style:p.value},null),g.value!==void 0?i("div",{class:"".concat(e.prefixCls,"-success-bg"),style:h.value},null):null])]),(s=t.default)===null||s===void 0?void 0:s.call(t)])}}});var xt={percent:0,prefixCls:"vc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1},Ot=function(e){var r=Q(null);return Ne(function(){var t=Date.now(),a=!1;e.value.forEach(function(o){var p=(o==null?void 0:o.$el)||o;if(p){a=!0;var g=p.style;g.transitionDuration=".3s, .3s, .3s, .06s",r.value&&t-r.value<100&&(g.transitionDuration="0s, 0s")}}),a&&(r.value=Date.now())}),e},wt={gapDegree:Number,gapPosition:{type:String},percent:{type:[Array,Number]},prefixCls:String,strokeColor:{type:[Object,String,Array]},strokeLinecap:{type:String},strokeWidth:Number,trailColor:String,trailWidth:Number,transition:String},It=["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","strokeColor"],de=0;function fe(n){return+n.replace("%","")}function ve(n){return Array.isArray(n)?n:[n]}function pe(n,e,r,t){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,p=50-t/2,g=0,h=-p,s=0,k=-2*p;switch(o){case"left":g=-p,h=0,s=2*p,k=0;break;case"right":g=p,h=0,s=-2*p,k=0;break;case"bottom":h=p,k=2*p;break}var d="M 50,50 m ".concat(g,",").concat(h,`
   a `).concat(p,",").concat(p," 0 1 1 ").concat(s,",").concat(-k,`
   a `).concat(p,",").concat(p," 0 1 1 ").concat(-s,",").concat(k),c=Math.PI*2*p,v={stroke:r,strokeDasharray:"".concat(e/100*(c-a),"px ").concat(c,"px"),strokeDashoffset:"-".concat(a/2+n/100*(c-a),"px"),transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s"};return{pathString:d,pathStyle:v}}const Dt=A({compatConfig:{MODE:3},name:"VCCircle",props:be(wt,xt),setup:function(e){de+=1;var r=Q(de),t=C(function(){return ve(e.percent)}),a=C(function(){return ve(e.strokeColor)}),o=We(),p=Me(o,2),g=p[0],h=p[1];Ot(h);var s=function(){var d=e.prefixCls,c=e.strokeWidth,v=e.strokeLinecap,y=e.gapDegree,_=e.gapPosition,x=0;return t.value.map(function(T,S){var W=a.value[S]||a.value[a.value.length-1],M=Object.prototype.toString.call(W)==="[object Object]"?"url(#".concat(d,"-gradient-").concat(r.value,")"):"",D=pe(x,T,W,c,y,_),u=D.pathString,l=D.pathStyle;x+=T;var f={key:S,d:u,stroke:M,"stroke-linecap":v,"stroke-width":c,opacity:T===0?0:1,"fill-opacity":"0",class:"".concat(d,"-circle-path"),style:l};return i("path",$({ref:g(S)},f),null)})};return function(){var k=e.prefixCls,d=e.strokeWidth,c=e.trailWidth,v=e.gapDegree,y=e.gapPosition,_=e.trailColor,x=e.strokeLinecap;e.strokeColor;var T=Ce(e,It),S=pe(0,100,_,d,v,y),W=S.pathString,M=S.pathStyle;delete T.percent;var D=a.value.find(function(l){return Object.prototype.toString.call(l)==="[object Object]"}),u={d:W,stroke:_,"stroke-linecap":x,"stroke-width":c||d,"fill-opacity":"0",class:"".concat(k,"-circle-trail"),style:M};return i("svg",$({class:"".concat(k,"-circle"),viewBox:"0 0 100 100"},T),[D&&i("defs",null,[i("linearGradient",{id:"".concat(k,"-gradient-").concat(r.value),x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[Object.keys(D).sort(function(l,f){return fe(l)-fe(f)}).map(function(l,f){return i("stop",{key:f,offset:l,"stop-color":D[l]},null)})])]),i("path",u,null),s().reverse()])}}});function $t(n){var e=n.percent,r=n.success,t=n.successPercent,a=F(J({success:r,successPercent:t}));return[a,F(F(e)-a)]}function Tt(n){var e=n.success,r=e===void 0?{}:e,t=n.strokeColor,a=r.strokeColor;return[a||te.green,t||null]}const jt=A({compatConfig:{MODE:3},name:"Circle",inheritAttrs:!1,props:Z(),setup:function(e,r){var t=r.slots,a=C(function(){if(e.gapDegree||e.gapDegree===0)return e.gapDegree;if(e.type==="dashboard")return 75}),o=C(function(){var c=e.width||120;return{width:typeof c=="number"?"".concat(c,"px"):c,height:typeof c=="number"?"".concat(c,"px"):c,fontSize:"".concat(c*.15+6,"px")}}),p=C(function(){return e.strokeWidth||6}),g=C(function(){return e.gapPosition||e.type==="dashboard"&&"bottom"||"top"}),h=C(function(){return $t(e)}),s=C(function(){return Object.prototype.toString.call(e.strokeColor)==="[object Object]"}),k=C(function(){return Tt({success:e.success,strokeColor:e.strokeColor})}),d=C(function(){var c;return c={},I(c,"".concat(e.prefixCls,"-inner"),!0),I(c,"".concat(e.prefixCls,"-circle-gradient"),s.value),c});return function(){var c;return i("div",{class:d.value,style:o.value},[i(Dt,{percent:h.value,strokeWidth:p.value,trailWidth:p.value,strokeColor:k.value,strokeLinecap:e.strokeLinecap,trailColor:e.trailColor,prefixCls:e.prefixCls,gapDegree:a.value,gapPosition:g.value},null),(c=t.default)===null||c===void 0?void 0:c.call(t)])}}});var Lt=function(){return $($({},Z()),{},{steps:Number,size:{type:String},strokeColor:String,trailColor:String})};const Nt=A({compatConfig:{MODE:3},name:"Steps",props:Lt(),setup:function(e,r){var t=r.slots,a=C(function(){return Math.round(e.steps*((e.percent||0)/100))}),o=C(function(){return e.size==="small"?2:14}),p=C(function(){for(var g=e.steps,h=e.strokeWidth,s=h===void 0?8:h,k=e.strokeColor,d=e.trailColor,c=e.prefixCls,v=[],y=0;y<g;y+=1){var _,x=(_={},I(_,"".concat(c,"-steps-item"),!0),I(_,"".concat(c,"-steps-item-active"),y<=a.value-1),_);v.push(i("div",{key:y,class:x,style:{backgroundColor:y<=a.value-1?k:d,width:"".concat(o.value,"px"),height:"".concat(s,"px")}},null))}return v});return function(){var g;return i("div",{class:"".concat(e.prefixCls,"-steps-outer")},[p.value,(g=t.default)===null||g===void 0?void 0:g.call(t)])}}}),Wt=A({compatConfig:{MODE:3},name:"AProgress",props:be(Z(),{type:"line",percent:0,showInfo:!0,trailColor:null,size:"default",strokeLinecap:"round"}),slots:["format"],setup:function(e,r){var t=r.slots,a=oe("progress",e),o=a.prefixCls,p=a.direction;ye(e.successPercent==null,"Progress","`successPercent` is deprecated. Please use `success.percent` instead.");var g=C(function(){var d,c=e.type,v=e.showInfo,y=e.size,_=o.value;return d={},I(d,_,!0),I(d,"".concat(_,"-").concat(c==="dashboard"&&"circle"||c),!0),I(d,"".concat(_,"-show-info"),v),I(d,"".concat(_,"-").concat(y),y),I(d,"".concat(_,"-rtl"),p.value==="rtl"),d}),h=C(function(){var d=e.percent,c=d===void 0?0:d,v=J(e);return parseInt(v!==void 0?v.toString():c.toString(),10)}),s=C(function(){var d=e.status;return De.indexOf(d)<0&&h.value>=100?"success":d||"normal"}),k=function(){var c=e.showInfo,v=e.format,y=e.type,_=e.percent,x=e.title,T=J(e);if(!c)return null;var S,W=v||(t==null?void 0:t.format)||function(D){return"".concat(D,"%")},M=y==="line";return v||t!=null&&t.format||s.value!=="exception"&&s.value!=="success"?S=W(F(_),F(T)):s.value==="exception"?S=M?i(ze,null,null):i(he,null,null):s.value==="success"&&(S=M?i(Ee,null,null):i(Ae,null,null)),i("span",{class:"".concat(o.value,"-text"),title:x===void 0&&typeof S=="string"?S:void 0},[S])};return function(){var d=e.type,c=e.steps,v=e.strokeColor,y=e.title,_=k(),x;d==="line"?x=c?i(Nt,$($({},e),{},{strokeColor:typeof v=="string"?v:void 0,prefixCls:o.value,steps:c}),{default:function(){return[_]}}):i(Pt,$($({},e),{},{prefixCls:o.value}),{default:function(){return[_]}}):(d==="circle"||d==="dashboard")&&(x=i(jt,$($({},e),{},{prefixCls:o.value}),{default:function(){return[_]}}));var T=$($({},g.value),{},I({},"".concat(o.value,"-status-").concat(s.value),!0));return i("div",{class:T,title:y},[x])}}}),Mt=Be(Wt);var zt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};const Et=zt;function ge(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),t.forEach(function(a){At(n,a,r[a])})}return n}function At(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}var le=function(e,r){var t=ge({},e,r.attrs);return i(Se,ge({},t,{icon:Et}),null)};le.displayName="MinusCircleOutlined";le.inheritAttrs=!1;const Bt=le;var Ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};const Ut=Ft;function me(n){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?Object(arguments[e]):{},t=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable}))),t.forEach(function(a){Rt(n,a,r[a])})}return n}function Rt(n,e,r){return e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}var ce=function(e,r){var t=me({},e,r.attrs);return i(Se,me({},t,{icon:Ut}),null)};ce.displayName="SyncOutlined";ce.inheritAttrs=!1;const Gt=ce;const Yt={key:0,class:"auto-completed-dirs"},Vt=A({__name:"localPathShortcut",props:{task:null,idx:null},emits:["update:task"],setup(n,{emit:e}){const r=n,t=Fe({get:()=>r.task,set:s=>e("update:task",s)}),a=we(),o=Pe(),{showDirAutoCompletedIdx:p}=ne(a),g=s=>{if(t.value.type==="download"){t.value.recv_dir=s;return}t.value.send_dirs.push(s)},h=["#f5222d","#1890ff","#ff3125","#d46b08","#007bff","#52c41a","#13c2c2","#fa541c","#eb2f96","#2f54eb"];return(s,k)=>{const d=Ie,c=Ue;return L(p)===n.idx&&L(o).autoCompletedDirList.length?(w(),G("div",Yt,[(w(!0),G(q,null,xe(L(o).autoCompletedDirList,(v,y)=>(w(),E(c,{key:v.dir,title:v.dir+"  点击添加"},{default:b(()=>[i(d,{visible:!L(t).send_dirs.includes(v.dir),color:h[y%h.length],onClick:_=>g(v.dir)},{default:b(()=>[j(re(v.zh),1)]),_:2},1032,["visible","color","onClick"])]),_:2},1032,["title"]))),128))])):N("",!0)}}});const ke=Oe(Vt,[["__scopeId","data-v-02736e53"]]),Ht=n=>(nt("data-v-d73dd318"),n=n(),rt(),n),Qt={class:"panel"},qt={class:"actions-bar"},Xt={class:"top-bar"},Jt=Ht(()=>R("div",{class:"flex-placeholder"},null,-1)),Zt={key:3},Kt={class:"action-bar"},en=A({__name:"taskRecord",props:{tabIdx:null,paneIdx:null},setup(n){const e=n,r=Je(!0),t=we(),a=Pe(),{tasks:o}=ne(t),{showDirAutoCompletedIdx:p}=ne(t),g=new Map,h=Q(10);ie(()=>a.openBaiduYunIfNotLogged(e.tabIdx,e.paneIdx)),Re(()=>{g.forEach(u=>u.clearTask())});const s=Q(!1);Ge([()=>t.pendingBaiduyunTaskQueue,s],async([u,l])=>{if(!(!u.length||!l)){console.log("processQueue",u);for(const f of u)o.value.unshift(r({...k(),...f})),c(0).then(()=>U.success("创建完成，在任务列表查看进度"));t.pendingBaiduyunTaskQueue=[]}},{deep:!0,immediate:!0}),ie(async()=>{const u=await Ye();o.value=it([...u.tasks,...o.value].map(r),f=>f.id).sort((f,O)=>Date.parse(O.start_time)-Date.parse(f.start_time)).slice(0,100);let l=o.value.filter(f=>f.running);l.filter(f=>!u.tasks.find(O=>O.id===f.id)).forEach(f=>{f.running=!1}),l=o.value.filter(f=>f.running),l.length&&l.forEach(f=>{v(f.id).completedTask.then(()=>U.success(`${f.type==="download"?"下载":"上传"}完成`))}),o.value.length||d(),s.value=!0,console.log("task record load")});const k=()=>r({type:"upload",send_dirs:[],recv_dir:"",id:"",running:!1,start_time:"",n_failed_files:0,n_files:0,n_success_files:0,canceled:!1}),d=()=>{o.value.unshift(k())},c=async u=>{const l=o.value[u];if(l.send_dirs=l.send_dirs.map(O=>O.trim()).filter(O=>O),l.recv_dir=l.recv_dir.trim(),!(l.type==="upload"?l.recv_dir.startsWith("/"):l.send_dirs.every(O=>O.startsWith("/"))))return U.error("百度云的位置必须以 “/” 开头");l.running=!0,l.n_files=100;const f=await Ve(l);l.id=f.id,v(f.id).completedTask.then(()=>U.success(l.type==="upload"?"上传完成":"下载完成"))},v=u=>{t.taskLogMap.set(u,[]);const l=dt.run({action:()=>He(u),pollInterval:t.pollInterval*1e3,validator(f){t.taskLogMap.get(u).push(...f.tasks);const O=o.value.findIndex(B=>B.id===u);return o.value[O]=r(f.task_summary),!f.task_summary.running}});return g.set(u,l),t.queue.pushAction(()=>l.completedTask),l},y=u=>parseInt(((u.n_failed_files+u.n_success_files)/u.n_files*100).toString()),_=u=>!!u.id&&!u.running&&!u.canceled,x=u=>u.running||_(u),T=u=>{const l=o.value[u];o.value.unshift({...k(),...Ze(l,"send_dirs","type","recv_dir")}),U.success("复制完成，已添加到最前端")},S=u=>{a.openLogDetailInRight(e.tabIdx,o.value[u].id)},W=async u=>{var O;const l=o.value[u],{last_tick:f}=await Ke(l.id);t.taskLogMap.get(l.id).push(...f.tasks),o.value[u]=r(f.task_summary),(O=g.get(l.id))==null||O.clearTask()},M=async u=>{const l=o.value[u];o.value.splice(u,1),l.id&&et(l.id),U.success("删除完成")},D=u=>{ut(u,`复制 "${u}" 成功，粘贴使用"`)};return(u,l)=>{const f=ct,O=tt,B=Ie,Y=at,K=ft,X=st,ee=ot,$e=Mt;return w(),G(q,null,[R("div",Qt,[R("div",qt,[i(f,{onClick:l[0]||(l[0]=m=>D("<#%Y-%m-%d#>"))},{default:b(()=>[j("复制日期占位符")]),_:1}),i(f,{onClick:l[1]||(l[1]=m=>D("<#%H-%M-%S#>"))},{default:b(()=>[j("复制时间占位符")]),_:1}),i(f,{onClick:l[2]||(l[2]=m=>D("<#%Y-%m-%d %H-%M-%S#>"))},{default:b(()=>[j("复制日期+时间占位符")]),_:1})])]),R("div",{class:"wrapper",onClick:l[4]||(l[4]=m=>p.value=-1)},[i(O,{style:{display:"none"}}),i(f,{onClick:d,block:"",style:{"border-radius":"8px"}},{icon:b(()=>[i(L(Qe))]),default:b(()=>[j(" 添加一个任务 ")]),_:1}),(w(!0),G(q,null,xe(L(o).slice(0,h.value),(m,z)=>(w(),G("div",{key:L(qe)(m),class:"task-form"},[R("div",Xt,[_(m)?(w(),E(B,{key:0,color:"success"},{default:b(()=>[j("已完成")]),_:1})):N("",!0),m.running?(w(),E(B,{key:1,color:"processing"},{icon:b(()=>[i(L(Gt),{spin:!0})]),default:b(()=>[j(re(m.type==="download"?"下载":"上传")+"中 ",1)]),_:2},1024)):N("",!0),m.canceled?(w(),E(B,{key:2,color:"default"},{icon:b(()=>[i(L(Bt))]),default:b(()=>[j(" 已取消 ")]),_:1})):N("",!0),Jt,m.start_time?(w(),G("div",Zt," 开始时间： "+re(m.start_time),1)):N("",!0)]),i(ee,{layout:"vertical","label-align":"left"},{default:b(()=>[i(Y,{label:"任务类型"},{default:b(()=>[i(L(Xe),{value:m.type,"onUpdate:value":P=>m.type=P,disabled:x(m),options:["upload","download"],conv:{value:P=>P,text:P=>P==="upload"?"上传":"下载"}},null,8,["value","onUpdate:value","disabled","conv"])]),_:2},1024),i(Y,{label:`发送的文件夹 (${m.type==="upload"?"本地":"百度云"})`,onClick:ue(P=>m.type==="upload"&&(p.value=z),["stop"])},{default:b(()=>[i(K,{"auto-size":"",disabled:x(m),value:m.send_dirs.join(),"onUpdate:value":P=>m.send_dirs=P.split(","),"allow-clear":"",placeholder:"发送文件的文件夹,多个文件夹使用逗号或者换行分隔。支持使用占位符例如stable-diffusion-webui最常用表示日期的<#%Y-%m-%d#>"},null,8,["disabled","value","onUpdate:value"]),m.type==="upload"?(w(),E(ke,{key:0,task:m,"onUpdate:task":P=>L(o)[z]=P,idx:z},null,8,["task","onUpdate:task","idx"])):N("",!0)]),_:2},1032,["label","onClick"]),i(Y,{label:`接收的文件夹 (${m.type!=="upload"?"本地":"百度云"})`},{default:b(()=>[i(X,{value:m.recv_dir,"onUpdate:value":P=>m.recv_dir=P,disabled:x(m),"allow-clear":"",onClick:ue(P=>m.type==="download"&&(p.value=z),["stop"]),placeholder:"用于接收的文件夹，支持使用占位符例如stable-diffusion-webui最常用表示日期的<#%Y-%m-%d#>"},null,8,["value","onUpdate:value","disabled","onClick"]),m.type==="download"?(w(),E(ke,{key:0,task:m,"onUpdate:task":P=>L(o)[z]=P,idx:z},null,8,["task","onUpdate:task","idx"])):N("",!0)]),_:2},1032,["label"])]),_:2},1024),R("div",Kt,[L(t).taskLogMap.get(m.id)?(w(),E(f,{key:0,onClick:P=>S(z)},{default:b(()=>[j("查看详细日志")]),_:2},1032,["onClick"])):N("",!0),i(f,{onClick:P=>T(z)},{default:b(()=>[j("复制该任务")]),_:2},1032,["onClick"]),m.running?(w(),E(f,{key:1,onClick:P=>W(z),danger:""},{default:b(()=>[j("取消任务")]),_:2},1032,["onClick"])):N("",!0),i(f,{onClick:P=>M(z),disabled:m.running,danger:""},{default:b(()=>[j("移除")]),_:2},1032,["onClick","disabled"]),_(m)?N("",!0):(w(),E(f,{key:2,type:"primary",loading:m.running,disabled:m.running,onClick:P=>c(z)},{default:b(()=>[j("开始")]),_:2},1032,["loading","disabled","onClick"]))]),m.running?(w(),E($e,{key:0,"stroke-color":{from:"#108ee9",to:"#87d068"},percent:y(m),status:"active"},null,8,["percent"])):N("",!0)]))),128)),h.value<L(o).length?(w(),E(f,{key:0,onClick:l[3]||(l[3]=m=>h.value+=5),block:"",style:{"border-radius":"8px"}},{default:b(()=>[j(" 继续加载 ")]),_:1})):N("",!0)])],64)}}});const un=Oe(en,[["__scopeId","data-v-d73dd318"]]);export{un as default};
