import{d as E,r as S,aW as L,x as H,o as d,l as T,c as a,m as r,n as e,p as V,q as z,t as F,A as Q,y as A,I as k,H as R,aL as j,K,O as W}from"./index-420d1f89.js";import{u as J,b as X,f as Y,c as Z,d as ee,e as se,h as le,j as te,k as ie,t as ae,L as ne,R as oe,l as re,S as ce}from"./fullScreenContextMenu-b2543b38.js";import{g as de,M as ue}from"./db-9ce80911.js";import"./index-e05f0539.js";import"./_baseIteratee-e264cf5a.js";import"./button-b1d89a54.js";const me={class:"hint"},pe={key:1,class:"preview-switch"},ve=E({__name:"MatchedImageGrid",props:{tabIdx:null,paneIdx:null,selectedTagIds:null,id:null},setup($){const u=$,l=S(),g=L();H(()=>u.selectedTagIds,async()=>{var s;const{res:i}=g.pushAction(()=>de(u.selectedTagIds));l.value=await i,(s=m.value)==null||s.scrollToItem(0)},{immediate:!0});const m=S(),I={tabIdx:-1,target:"local",paneIdx:-1,walkMode:!1},{stackViewEl:B,multiSelectedIdxs:p,stack:G}=J().toRefs(),{itemSize:w,gridItems:N}=X(I),{showMenuIdx:v}=Y();Z();const{showGenInfo:c,imageGenInfo:x,q:O,onContextMenuClick:P,onFileItemClick:U}=ee(I,{openNext:j}),{previewIdx:n,previewing:C,onPreviewVisibleChange:q,previewImgMove:_,canPreview:y}=se(u,{scroller:m,files:l}),b=async(i,s,o)=>{G.value=[{curr:"",files:l.value}];const f=p.value.includes(o)?p.value:[o];await P(i,s,o),i.key==="deleteFiles"&&(l.value=l.value.filter((h,t)=>!f.includes(t)))};return(i,s)=>{const o=K,f=ue,h=ce;return d(),T("div",{class:"container",ref_key:"stackViewEl",ref:B},[a(h,{size:"large",spinning:!e(g).isIdle},{default:r(()=>[a(f,{visible:e(c),"onUpdate:visible":s[1]||(s[1]=t=>V(c)?c.value=t:null),width:"70vw","mask-closable":"",onOk:s[2]||(s[2]=t=>c.value=!1)},{cancelText:r(()=>[]),default:r(()=>[a(o,{active:"",loading:!e(O).isIdle},{default:r(()=>[z("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:s[0]||(s[0]=t=>e(le)(e(x),"copied"))},[z("div",me,F(i.$t("doubleClickToCopy")),1),Q(" "+F(e(x)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),l.value?(d(),A(e(te),{key:0,ref_key:"scroller",ref:m,class:"file-list",items:l.value,"item-size":e(w).first,"key-field":"fullpath","item-secondary-size":e(w).second,gridItems:e(N)},{default:r(({item:t,index:M})=>[a(ie,{idx:M,file:t,"show-menu-idx":e(v),"onUpdate:showMenuIdx":s[3]||(s[3]=D=>V(v)?v.value=D:null),onFileItemClick:e(U),"full-screen-preview-image-url":l.value[e(n)]?e(ae)(l.value[e(n)]):"",selected:e(p).includes(M),onContextMenuClick:b,onPreviewVisibleChange:e(q)},null,8,["idx","file","show-menu-idx","onFileItemClick","full-screen-preview-image-url","selected","onPreviewVisibleChange"])]),_:1},8,["items","item-size","item-secondary-size","gridItems"])):k("",!0),e(C)?(d(),T("div",pe,[a(e(ne),{onClick:s[4]||(s[4]=t=>e(_)("prev")),class:R({disable:!e(y)("prev")})},null,8,["class"]),a(e(oe),{onClick:s[5]||(s[5]=t=>e(_)("next")),class:R({disable:!e(y)("next")})},null,8,["class"])])):k("",!0)]),_:1},8,["spinning"]),e(C)&&l.value&&l.value[e(n)]?(d(),A(re,{key:0,file:l.value[e(n)],idx:e(n),onContextMenuClick:b},null,8,["file","idx"])):k("",!0)],512)}}});const Ce=W(ve,[["__scopeId","data-v-e9904601"]]);export{Ce as default};
