import{d as w,F as b,J as V,b0 as N,r as _,G as T,aV as q,y as A,K as s,L as o,Q as c,W as v,V as y,a as D,M as l,ah as F,O as d,N as h,R as u,U as g,X as G,Y as M,aq as U,a0 as $}from"./index-935c2795.js";/* empty css              */import{a as f,u as L}from"./db-f3cd9ce7.js";import{B as O}from"./button-190f793c.js";const Q={class:"container"},R={class:"tag-list"},z=["onClick"],E=w({__name:"TagSearch",props:{tabIdx:null,paneIdx:null},setup(k){const x=k,I=b(),i=V(new N),a=_(),t=_(new Set),r=T(()=>a.value?a.value.tags.slice().sort((p,n)=>n.count-p.count):[]),C=q();A(async()=>{a.value=await f()});const S=async()=>{i.pushAction(async()=>{await L(),a.value=await f()})},B=()=>{I.openTagSearchMatchedImageGridInRight(x.tabIdx,C,Array.from(t.value))};return(p,n)=>{const m=O;return s(),o("div",Q,[c("",!0),a.value?(s(),o(v,{key:1},[y("div",null,[D(l(F),{conv:{value:e=>e.id,text:e=>e.display_name?`${e.display_name} : ${e.name}`:e.name},mode:"multiple",style:{width:"100%"},options:l(r),value:Array.from(t.value),"onUpdate:value":n[0]||(n[0]=e=>t.value=new Set(e))},null,8,["conv","options","value"])]),a.value.expired||!a.value.img_count?(s(),d(m,{key:0,onClick:S,loading:!i.isIdle,type:"primary"},{default:h(()=>[u(g(a.value.img_count===0?"gen idx":"updat index"),1)]),_:1},8,["loading"])):(s(),d(m,{key:1,type:"primary",onClick:B,loading:!i.isIdle},{default:h(()=>[u("search")]),_:1},8,["loading"])),y("ul",R,[(s(!0),o(v,null,G(l(r),e=>(s(),o("li",{key:e.id,class:M(["tag",{selected:t.value.has(e.id)}]),onClick:J=>t.value.has(e.id)?t.value.delete(e.id):t.value.add(e.id)},[t.value.has(e.id)?(s(),d(l(U),{key:0})):c("",!0),u(" "+g(e.name),1)],10,z))),128))])],64)):c("",!0)])}}});const j=$(E,[["__scopeId","data-v-2e81dd00"]]);export{j as default};
