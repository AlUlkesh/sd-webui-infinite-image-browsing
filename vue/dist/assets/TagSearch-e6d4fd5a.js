import{d as b,F as N,J as T,b0 as V,r as y,G as q,aV as A,y as D,K as n,L as l,Q as d,W as h,V as r,a as G,M as c,ah as U,O as u,N as g,R as p,U as f,X as F,Y as M,aq as $,a0 as L}from"./index-5ac24ab3.js";/* empty css              */import{a as k,u as O}from"./db-4a7d2db8.js";import{B as Q}from"./button-bebb2235.js";const R={class:"container"},z={class:"tag-list"},E=["onClick"],J=b({__name:"TagSearch",props:{tabIdx:null,paneIdx:null},setup(x){const I=x,S=N(),i=T(new V),a=y(),t=y(new Set),m=q(()=>a.value?a.value.tags.slice().sort((s,o)=>o.count-s.count):[]),C=A();D(async()=>{a.value=await k()});const B=async()=>{i.pushAction(async()=>{await O(),a.value=await k()})},w=()=>{S.openTagSearchMatchedImageGridInRight(I.tabIdx,C,Array.from(t.value))},_=s=>s.display_name?`${s.display_name} : ${s.name}`:s.name;return(s,o)=>{const v=Q;return n(),l("div",R,[d("",!0),a.value?(n(),l(h,{key:1},[r("div",null,[r("div",null,[G(c(U),{conv:{value:e=>e.id,text:_},mode:"multiple",style:{width:"100%"},options:c(m),value:Array.from(t.value),placeholder:"Select tags to match images","onUpdate:value":o[0]||(o[0]=e=>t.value=new Set(e))},null,8,["conv","options","value"])]),a.value.expired||!a.value.img_count?(n(),u(v,{key:0,onClick:B,loading:!i.isIdle,type:"primary"},{default:g(()=>[p(f(a.value.img_count===0?"Generate index for search image":"Update index"),1)]),_:1},8,["loading"])):(n(),u(v,{key:1,type:"primary",onClick:w,loading:!i.isIdle},{default:g(()=>[p("Search")]),_:1},8,["loading"]))]),r("ul",z,[(n(!0),l(h,null,F(c(m),e=>(n(),l("li",{key:e.id,class:M(["tag",{selected:t.value.has(e.id)}]),onClick:K=>t.value.has(e.id)?t.value.delete(e.id):t.value.add(e.id)},[t.value.has(e.id)?(n(),u(c($),{key:0})):d("",!0),p(" "+f(_(e)),1)],10,E))),128))])],64)):d("",!0)])}}});const H=L(J,[["__scopeId","data-v-dc256362"]]);export{H as default};
