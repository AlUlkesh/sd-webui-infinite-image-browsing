import{b as ie,t as B,w as L,c as u,d as E,i as V,u as se,_ as g,S as le,a as fe,P as y,e as ce,r as T,o as de,f as ve,g as me,h as pe,j as _e,k,l as ge,m as Se,n as be,p as xe,q as R,s as $,v as Ce,x as $e,y as ye,z as Re,A as we}from"./index-ac425f1f.js";import{b as ke,a as Te,t as z,R as Me,C as Ae,I as he,B as De,T as Ne}from"./index-164dea42.js";import"./index-cb979deb.js";var Ue=9007199254740991,Ee=Math.floor;function F(a,e){var n="";if(!a||e<1||e>Ue)return n;do e%2&&(n+=a),e=Ee(e/2),e&&(a+=a);while(e);return n}function Ie(a,e,n){var t=a.length;return n=n===void 0?t:n,!e&&n>=t?a:ke(a,e,n)}var Oe="\\ud800-\\udfff",Pe="\\u0300-\\u036f",je="\\ufe20-\\ufe2f",Fe="\\u20d0-\\u20ff",He=Pe+je+Fe,Be="\\ufe0e\\ufe0f",Le="\\u200d",Ve=RegExp("["+Le+Oe+He+Be+"]");function I(a){return Ve.test(a)}var ze=Te("length");const Je=ze;var J="\\ud800-\\udfff",qe="\\u0300-\\u036f",We="\\ufe20-\\ufe2f",Ze="\\u20d0-\\u20ff",Ge=qe+We+Ze,Xe="\\ufe0e\\ufe0f",Ye="["+J+"]",h="["+Ge+"]",D="\\ud83c[\\udffb-\\udfff]",Ke="(?:"+h+"|"+D+")",q="[^"+J+"]",W="(?:\\ud83c[\\udde6-\\uddff]){2}",Z="[\\ud800-\\udbff][\\udc00-\\udfff]",Qe="\\u200d",G=Ke+"?",X="["+Xe+"]?",ea="(?:"+Qe+"(?:"+[q,W,Z].join("|")+")"+X+G+")*",aa=X+G+ea,ta="(?:"+[q+h+"?",h,W,Z,Ye].join("|")+")",H=RegExp(D+"(?="+D+")|"+ta+aa,"g");function na(a){for(var e=H.lastIndex=0;H.test(a);)++e;return e}function O(a){return I(a)?na(a):Je(a)}function ra(a){return a.split("")}var Y="\\ud800-\\udfff",oa="\\u0300-\\u036f",ua="\\ufe20-\\ufe2f",ia="\\u20d0-\\u20ff",sa=oa+ua+ia,la="\\ufe0e\\ufe0f",fa="["+Y+"]",N="["+sa+"]",U="\\ud83c[\\udffb-\\udfff]",ca="(?:"+N+"|"+U+")",K="[^"+Y+"]",Q="(?:\\ud83c[\\udde6-\\uddff]){2}",ee="[\\ud800-\\udbff][\\udc00-\\udfff]",da="\\u200d",ae=ca+"?",te="["+la+"]?",va="(?:"+da+"(?:"+[K,Q,ee].join("|")+")"+te+ae+")*",ma=te+ae+va,pa="(?:"+[K+N+"?",N,Q,ee,fa].join("|")+")",_a=RegExp(U+"(?="+U+")|"+pa+ma,"g");function ga(a){return a.match(_a)||[]}function Sa(a){return I(a)?ga(a):ra(a)}var ba=Math.ceil;function ne(a,e){e=e===void 0?" ":ie(e);var n=e.length;if(n<2)return n?F(e,a):e;var t=F(e,ba(a/O(e)));return I(e)?Ie(Sa(t),0,a).join(""):t.slice(0,a)}function xa(a,e,n){a=B(a),e=z(e);var t=e?O(a):0;return e&&t<e?ne(e-t,n)+a:a}const Ca=L(Me),$a=L(Ae);function ya(a,e,n){a=B(a),e=z(e);var t=e?O(a):0;return e&&t<e?a+ne(e-t,n):a}var re=function(e){var n=e.value,t=e.formatter,s=e.precision,f=e.decimalSeparator,m=e.groupSeparator,c=m===void 0?"":m,l=e.prefixCls,d;if(typeof t=="function")d=t({value:n});else{var p=String(n),v=p.match(/^(-?)(\d*)(\.(\d+))?$/);if(!v)d=p;else{var o=v[1],r=v[2]||"0",i=v[4]||"";r=r.replace(/\B(?=(\d{3})+(?!\d))/g,c),typeof s=="number"&&(i=ya(i,s,"0").slice(0,s)),i&&(i="".concat(f).concat(i)),d=[u("span",{key:"int",class:"".concat(l,"-content-value-int")},[o,r]),i&&u("span",{key:"decimal",class:"".concat(l,"-content-value-decimal")},[i])]}}return u("span",{class:"".concat(l,"-content-value")},[d])};re.displayName="StatisticNumber";const Ra=re;var oe=function(){return{prefixCls:String,decimalSeparator:String,groupSeparator:String,format:String,value:{type:[String,Number,Object]},valueStyle:{type:Object,default:void 0},valueRender:y.any,formatter:y.any,precision:Number,prefix:y.any,suffix:y.any,title:y.any,loading:{type:Boolean,default:void 0}}};const S=E({compatConfig:{MODE:3},name:"AStatistic",props:V(oe(),{decimalSeparator:".",groupSeparator:",",loading:!1}),slots:["title","prefix","suffix","formatter"],setup:function(e,n){var t=n.slots,s=se("statistic",e),f=s.prefixCls,m=s.direction;return function(){var c,l,d,p,v,o,r,i=e.value,b=i===void 0?0:i,x=e.valueStyle,C=e.valueRender,_=f.value,w=(c=e.title)!==null&&c!==void 0?c:(l=t.title)===null||l===void 0?void 0:l.call(t),P=(d=e.prefix)!==null&&d!==void 0?d:(p=t.prefix)===null||p===void 0?void 0:p.call(t),j=(v=e.suffix)!==null&&v!==void 0?v:(o=t.suffix)===null||o===void 0?void 0:o.call(t),ue=(r=e.formatter)!==null&&r!==void 0?r:t.formatter,M=u(Ra,g({"data-for-update":Date.now()},g(g({},e),{},{prefixCls:_,value:b,formatter:ue})),null);return C&&(M=C(M)),u("div",{class:[_,fe({},"".concat(_,"-rtl"),m.value==="rtl")]},[w&&u("div",{class:"".concat(_,"-title")},[w]),u(le,{paragraph:!1,loading:e.loading},{default:function(){return[u("div",{style:x,class:"".concat(_,"-content")},[P&&u("span",{class:"".concat(_,"-content-prefix")},[P]),M,j&&u("span",{class:"".concat(_,"-content-suffix")},[j])])]}})])}}});var wa=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function ka(a,e){var n=a,t=/\[[^\]]*]/g,s=(e.match(t)||[]).map(function(l){return l.slice(1,-1)}),f=e.replace(t,"[]"),m=wa.reduce(function(l,d){var p=ce(d,2),v=p[0],o=p[1];if(l.indexOf(v)!==-1){var r=Math.floor(n/o);return n-=r*o,l.replace(new RegExp("".concat(v,"+"),"g"),function(i){var b=i.length;return xa(r.toString(),b,"0")})}return l},f),c=0;return m.replace(t,function(){var l=s[c];return c+=1,l})}function Ta(a,e){var n=e.format,t=n===void 0?"":n,s=new Date(a).getTime(),f=Date.now(),m=Math.max(s-f,0);return ka(m,t)}var Ma=1e3/30;function A(a){return new Date(a).getTime()}var Aa=function(){return g(g({},oe()),{},{value:[Number,String,Object],format:String,onFinish:Function,onChange:Function})};const ha=E({compatConfig:{MODE:3},name:"AStatisticCountdown",props:V(Aa(),{format:"HH:mm:ss"}),setup:function(e,n){var t=n.emit,s=n.slots,f=T(),m=T(),c=function(){var r=e.value,i=A(r);i>=Date.now()?l():d()},l=function(){if(!f.value){var r=A(e.value);f.value=setInterval(function(){m.value.$forceUpdate(),r>Date.now()&&t("change",r-Date.now()),c()},Ma)}},d=function(){var r=e.value;if(f.value){clearInterval(f.value),f.value=void 0;var i=A(r);i<Date.now()&&t("finish")}},p=function(r){var i=r.value,b=r.config,x=e.format;return Ta(i,g(g({},b),{},{format:x}))},v=function(r){return r};return de(function(){c()}),ve(function(){c()}),me(function(){d()}),function(){var o=e.value;return u(S,g({ref:m},g(g({},pe(e,["onFinish","onChange"])),{},{value:o,valueRender:v,formatter:p})),s)}}});S.Countdown=ha;S.install=function(a){return a.component(S.name,S),a.component(S.Countdown.name,S.Countdown),a};S.Countdown;const Da={class:"container"},Na=E({__name:"autoUpload",emits:["runningChange"],setup(a,{emit:e}){const n=_e(),t=T([]),s=T(),f=k(()=>!!(s.value||t.value.length));ge(()=>e("runningChange",f.value));const m=Se(new Map),c=k(()=>Array.from(m.values())),l=k(()=>c.value.reduce((o,r)=>o+r.n_success_files,0)),d=k(()=>c.value.reduce((o,r)=>o+r.n_failed_files,0)),p=()=>Ne.run({action:async()=>{const o=await ye(n.autoUploadRecvDir);return o.tick_info&&m.set(o.tick_info.task_summary.id,o.tick_info.task_summary),t.value=o.pending_files,await Re(1e4*Math.random()),o},pollInterval:3e4}),v=async()=>{s.value?(s.value.clearTask(),s.value=void 0,t.value=[]):s.value=p()};return(o,r)=>{const i=he,b=De,x=S,C=$a,_=Ca;return be(),xe("div",Da,[u(i,{value:R(n).autoUploadRecvDir,"onUpdate:value":r[0]||(r[0]=w=>R(n).autoUploadRecvDir=w)},null,8,["value"]),u(b,{onClick:v,loading:R(f)},{default:$(()=>[Ce($e(s.value?"暂停":"开始"),1)]),_:1},8,["loading"]),u(_,null,{default:$(()=>[u(C,{span:12},{default:$(()=>[u(x,{title:"等待上传数量",value:t.value.length,style:{"margin-right":"50px"}},null,8,["value"])]),_:1}),u(C,{span:12},{default:$(()=>[u(x,{title:"上传失败数量",value:R(d)},null,8,["value"])]),_:1})]),_:1}),u(_,null,{default:$(()=>[u(C,{span:12},{default:$(()=>[u(x,{title:"已完成数量",value:R(l),style:{"margin-right":"50px"}},null,8,["value"])]),_:1})]),_:1})])}}});const Pa=we(Na,[["__scopeId","data-v-8db10f61"]]);export{Pa as default};
